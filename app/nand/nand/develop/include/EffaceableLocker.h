#ifndef EFFACEABLELOCKER_H
#define EFFACEABLELOCKER_H

#include "NANDCore.h"
////////////////////////////////////////////////////////////////////////////////
//
//
//
////////////////////////////////////////////////////////////////////////////////
class EffaceableLockers
{
public:
    EffaceableLockers(ByteBuffer const& data);

    auto get_emf(ByteBuffer const& k89b)  -> ByteBuffer;
    auto get_dkey(ByteBuffer const& k835) -> ByteBuffer;
    auto get_locker(string const& tag)    -> ByteBuffer;
    auto to_s() -> string;
    
private:
    map<string, ByteBuffer> _lockers;
};

bool check_effaceable_header(ByteBuffer plog);
////////////////////////////////////////////////////////////////////////////////
//
//
//
////////////////////////////////////////////////////////////////////////////////
#endif
